import{a as Y,b as $,c as H,d as z,e as J,f as K,g as Q,h as U,i as W,j as X,k as Z,l as me,m as le,n as se,o as de,p as pe,q as ce,r as ue,s as fe,t as ye,u as ge,v as ve,w as he,x as Ee,y as _e}from"./chunk-NGXTZCCX.js";import{f as N}from"./chunk-HWATMX45.js";import{J as ee,L as te,M as ie,N as oe,O as re,P as ae,Q as ne,R as Me,l as w,n as p,p as A,q,s as O,t as T,u as V,v as G,w as B,x as j,y as R,z as L}from"./chunk-J4VW5AI3.js";import{K as P,Q as k}from"./chunk-MO7EXJXY.js";import{Cb as E,Eb as M,Lb as _,Mb as o,Ob as S,Ta as a,Tb as b,Ua as u,ga as x,ib as g,kb as m,pa as v,qa as h,qc as F,rc as C,tb as t,ub as e,uc as I,vb as y,zb as D}from"./chunk-EASKA4KA.js";function xe(l,d){l&1&&(t(0,"mat-error"),o(1," *Invalid identity format. Please enter 9 digits. "),e())}function be(l,d){l&1&&(t(0,"mat-error"),o(1," *You must be at least 16 years old "),e())}function Fe(l,d){if(l&1&&(t(0,"mat-option",35),o(1),e()),l&2){let c=d.$implicit,i=M(2);m("value",c.id)("disabled",i.isPositionSelected(c.id)),a(),S(" ",c.name," ")}}function Ce(l,d){l&1&&(t(0,"mat-error"),o(1," *start date must be after entry date "),e())}function Ie(l,d){if(l&1){let c=D();t(0,"div")(1,"div",26)(2,"mat-card")(3,"mat-card-header")(4,"mat-card-title"),o(5),e()(),t(6,"mat-card-content")(7,"mat-form-field",27)(8,"mat-label",28),o(9,"Choose Position"),e(),t(10,"mat-select",29),g(11,Fe,2,3,"mat-option",30),e()(),t(12,"mat-form-field")(13,"mat-label",31),o(14,"Start Date"),e(),y(15,"input",32)(16,"mat-datepicker-toggle",15)(17,"mat-datepicker",null,2),g(19,Ce,2,0,"mat-error",8),e(),t(20,"mat-form-field")(21,"mat-label",33),o(22,"Is Management"),e(),t(23,"mat-select",34)(24,"mat-option",20),o(25,"True"),e(),t(26,"mat-option",20),o(27,"False"),e()()(),t(28,"button",23),E("click",function(){let r=v(c).index,n=M();return h(n.removePosition(r))}),t(29,"mat-icon"),o(30,"delete"),e(),o(31,"Remove"),e()()()()()}if(l&2){let c=d.index,i=_(18),r=M();a(),m("formGroupName",c),a(4),S("Position ",c+1,""),a(6),m("ngForOf",r.positionslist),a(4),m("matDatepicker",i),a(),m("for",i),a(3),m("ngIf",r.validateEntryDate),a(5),m("value",!0),a(2),m("value",!1)}}var ot=(()=>{let d=class d{constructor(i,r,n,s,f,De,Se){this.dialogRef=i,this.formBuilder=r,this.employeeService=n,this.router=s,this.dialog=f,this.employeePositionService=De,this._positionService=Se}ngOnInit(){this._positionService.getPositionList().subscribe(i=>{console.log(i),this.positionslist=i}),this.employeeForm=this.formBuilder.group({identity:["",[p.required,p.pattern("^[0-9]{9}$")]],firstName:["",p.required],lastName:["",p.required],entryDate:["",p.required],birthDate:["",p.required,this.validateBirthDate.bind(this)],gender:["",p.required],positions:this.formBuilder.array([])})}validateEntryDate(i){return new Promise(r=>{let n=new Date(i.value);new Date(this.employeeForm.value.entryDate)>n?r({invalidateEntryDate:!0}):r(null)})}validateBirthDate(i){return new Promise(r=>{let n=new Date(i.value);new Date().getFullYear()-n.getFullYear()<16?r({underSixteen:!0}):r(null)})}onSubmit(){if(this.employeeForm.valid){let i={identity:this.employeeForm.value.identity,firstName:this.employeeForm.value.firstName,lastName:this.employeeForm.value.lastName,entryDate:this.employeeForm.value.entryDate,birthDate:this.employeeForm.value.birthDate,gender:this.employeeForm.value.gender};console.log(i),this.employeeService.setNewEmployee(i).subscribe(r=>{r&&(console.log("Employee added successfully:",r),this.savePositions(r))})}}savePositions(i){let n=this.employeeForm.get("positions").value;n.forEach(s=>{s.employeeId=i.id,console.log(s)}),this.employeePositionService.addNewEmployeePositions(n).subscribe(s=>{console.log("Employee position added successfully:",s),this.router.navigate(["/employee-list"]),this.employeeService.getEmployeeList().subscribe(),this.dialogRef.close()},s=>{console.error("Error adding employee position:",s)})}onCancel(){this.dialogRef.close()}get positions(){return this.employeeForm.get("positions")}addPosition(){this.employeeForm.get("positions").push(this.createPositionFormGroup())}removePosition(i){this.employeeForm.get("positions").removeAt(i)}createPositionFormGroup(){return this.formBuilder.group({employeeId:0,positionId:["",p.required],startDate:["",p.required,this.validateEntryDate.bind(this)],isManagement:["",p.required]})}isPositionSelected(i){return this.positions.controls.map(n=>n.get("positionId").value).includes(i)}};d.\u0275fac=function(r){return new(r||d)(u(ee),u(R),u(Ee),u(N),u(te),u(Me),u(_e))},d.\u0275cmp=x({type:d,selectors:[["app-add-employee"]],standalone:!0,features:[b],decls:52,vars:10,consts:[["entryDatePicker",""],["picker",""],["startDatePicker",""],["mat-dialog-title",""],[1,"mat-typography"],[3,"formGroup"],["for","identity"],["matInput","","formControlName","identity","type","text","required",""],[4,"ngIf"],["for","firstName"],["matInput","","formControlName","firstName","type","text","required",""],["for","lastName"],["matInput","","formControlName","lastName","type","text","required",""],["for","entryDate"],["matInput","","formControlName","entryDate","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["for","birthDate"],["matInput","","formControlName","birthDate","required","",3,"matDatepicker"],["for","gender"],["placeholder","Gender","formControlName","gender","required",""],[3,"value"],["formArrayName","positions"],[4,"ngFor","ngForOf"],["mat-button","","type","button",3,"click"],["mat-button","","mat-dialog-close",""],["mat-button","",3,"click"],[3,"formGroupName"],["appearance","fill"],["for","positionId"],["formControlName","positionId","required",""],[3,"value","disabled",4,"ngFor","ngForOf"],["for","startDate"],["matInput","","formControlName","startDate","required","",3,"matDatepicker"],["for","isManagement"],["formControlName","isManagement","required",""],[3,"value","disabled"]],template:function(r,n){if(r&1){let s=D();t(0,"div")(1,"h1",3),o(2,"Add Employee"),e(),t(3,"mat-dialog-content",4)(4,"form",5)(5,"mat-form-field")(6,"mat-label",6),o(7,"Identity"),e(),y(8,"input",7),g(9,xe,2,0,"mat-error",8),e(),t(10,"mat-form-field")(11,"mat-label",9),o(12,"First Name"),e(),y(13,"input",10),e(),t(14,"mat-form-field")(15,"mat-label",11),o(16,"Last Name"),e(),y(17,"input",12),e(),t(18,"mat-form-field")(19,"mat-label",13),o(20,"Entry Date"),e(),y(21,"input",14)(22,"mat-datepicker-toggle",15)(23,"mat-datepicker",null,0),e(),t(25,"mat-form-field")(26,"mat-label",16),o(27,"Birth Date"),e(),y(28,"input",17)(29,"mat-datepicker-toggle",15)(30,"mat-datepicker",null,1),g(32,be,2,0,"mat-error",8),e(),t(33,"mat-form-field")(34,"mat-label",18),o(35,"Gender"),e(),t(36,"mat-select",19)(37,"mat-option",20),o(38,"Male"),e(),t(39,"mat-option",20),o(40,"Female"),e()()(),t(41,"form",21),g(42,Ie,32,8,"div",22),e()()(),t(43,"mat-dialog-actions")(44,"button",23),E("click",function(){return v(s),h(n.addPosition())}),t(45,"mat-icon"),o(46,"add"),e(),o(47,"Add Position"),e(),t(48,"button",24),o(49,"Cancel"),e(),t(50,"button",25),E("click",function(){return v(s),h(n.onSubmit())}),o(51,"Add"),e()()()}if(r&2){let s=_(24),f=_(31);a(4),m("formGroup",n.employeeForm),a(5),m("ngIf",n.employeeForm.get("identity").hasError("pattern")),a(12),m("matDatepicker",s),a(),m("for",s),a(6),m("matDatepicker",f),a(),m("for",f),a(3),m("ngIf",n.employeeForm.get("birthDate").hasError("underSixteen")),a(5),m("value",0),a(2),m("value",1),a(3),m("ngForOf",n.positions.controls)}},dependencies:[W,U,he,ve,ue,ye,ge,fe,ce,se,de,pe,Z,X,ne,ie,oe,ae,re,J,z,Y,$,H,Q,K,L,O,w,A,q,j,T,B,V,G,I,F,C,le,me,k,P],styles:[".mat-form-field[_ngcontent-%COMP%]{width:100%}mat-card[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}mat-card-header[_ngcontent-%COMP%], mat-card-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}mat-card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-mdc-dialog-content[_ngcontent-%COMP%]{max-height:78vh}"]});let l=d;return l})();export{ot as a};
